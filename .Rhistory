knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, caret, lme4)
raw_df <- read_csv("../a3-1/finalish_data.csv")
library(tidyverse, caret, lme4)
pacman::p_load(tidyverse, caret, lme4)
pacman::p_load(tidyverse, caret, lme4)
raw_df <- read_csv("../a3-1/finalish_data.csv"
raw_df %>%
pacman::p_load(tidyverse, caret, lme4)
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
Diagnosis = as.factor(Diagnosis)
)
lme4::glmer(Diagnosis ~ pitch_variability + (1|real_id), )
?glmer
pacman::p_load(tidyverse, caret, lme4, broomMixed)
pacman::p_load(tidyverse, caret, lme4, broom.mixed)
raw_df %>%
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID), family = binomial)
str(raw_df)
raw_df %>%
mutate(
Language = as.factor(Language),
Diagnosis = as.factor(Diagnosis),
real_ID = as.factor(real_ID)
)
raw_df %>%
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID), family = binomial)
str(raw_df)
danish_df <- raw_df %>%
filter(Language == Danish)
raw_df$Language
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_dat, family = "binomial")
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_dat, family = "binomial")
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
raw_df %>%
mutate(
Language = as.factor(Language),
Diagnosis = as.factor(Diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
class(raw_df)
class(raw_df$Diagnosis)
class(raw_df$diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
class(raw_df$diagnosis)
class(raw_df$Diagnosis)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
danish_df <- raw_df %>%
filter(Language == "Danish")
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
lme4::glmer(formula = diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
class(raw_df$Diagnosis)
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish")
lme4::glmer(formula = diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
danish_df$diagnosis
class(danish_df$diagnosis)
lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
to_logit <- function(x) 1/(1-p)^2
predict_to_tibble <- function(model) {
predict(model, type="response") %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
to_logit <- function(x) 1/(1-p)^2
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
to_logit <- function(x) 1/(1-p)^2
predict_to_tibble <- function(model) {
predict(model, type="response") %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish")
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
predict_to_tibble(simple_model)
?predict()
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_numer())
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number())
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
?predict()
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
predict_to_tibble <- function(model) {
predict(model, type="response", re.form=NA) %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number())
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
to_logit <- function(x) exp(x)/(1-exp(x)
predict_to_tibble <- function(model) {
predict_to_tibble <- function(model) {
predict(model, type="response", re.form=NA) %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number())
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
augment(simple_model)
result <- simple_model %>%
augment %>%
mutate(prediction <- to_logit(.fitted))
result <- simple_model %>%
augment %>%
mutate(prediction = to_logit(.fitted))
result <- simple_model %>%
augment %>%
mutate(pred = to_logit(.fitted))
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
predicted = if_else(pred < 0.5, "Control", "Schizophrenia")) %>%
select(predicted, pred)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
logit2prob <- function(x) exp(x)/(1-exp(x)
predict_to_tibble <- function(model) {
logit2prob <- function(x) exp(x)/(1-exp(x)
predict_to_tibble <- function(model) {
logit2prob <- function(x) {exp(x)/(1-exp(x)}
logit2prob <- function(x) {
logit2prob <- function(x) {
exp(x)/(1-exp(x))
}
predict_to_tibble <- function(model) {
predict(model, type="response", re.form=NA) %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
logit2prob <- function(x) {
exp(x) / (1 - exp(x))
}
predict_to_tibble <- function(model) {
predict(model, type = "response", re.form = NA) %>%
as_tibble() %>%
mutate(row_num = row_number(),
pred = if_else(value > 0.5, "Schizophrenia", "Control")) %>%
select(row_num, pred)
}
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number())
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = if_else(pred < 0.5, "Control", "Schizophrenia")) %>%
select(result, Diagnosis)
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
result
caret::confusionMatrix(result)
caret::confusionMatrix(result, reference = "Diagnosis", d = "result")
caret::confusionMatrix(result, reference = "Diagnosis")
result$result
result$Diagnosis
class(result$Diagnosis)
d <- fold(d,k=5,cat_col = "Diagnosis", id_col = "real_ID") %>%
arrange(.fold)
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms)
d <- fold(d,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
groupdata2
pacman::p_load(tidyverse, caret, lme4, broom.mixed, cvms, groupdata2)
d <- fold(d,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number())
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = if_else(pred < 0.5, "Control", "Schizophrenia")) %>%
select(result, Diagnosis)
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
class(result$Diagnosis)
caret::confusionMatrix(result, reference = "Diagnosis")
d <- fold(d,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
class(danish_df$real_ID)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number(),
real_ID = as.factor(real_ID))
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = if_else(pred < 0.5, "Control", "Schizophrenia")) %>%
select(result, Diagnosis)
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.fold)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID")
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID")
d
d %>% arrange
d %>% arrange(.folds)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.folds)
?confusionMatrix
caret::confusionMatrix(result$result, reference = "Diagnosis")
n(result$result)
nrow(result$result)
nrow(result)
length(result$Diagnosis)
length(result$result)
class(result$result)
class(result$Diagnosis)
result$Diagnosis
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = as.factor(if_else(pred < 0.5, "Control", "Schizophrenia"))) %>%
select(result, Diagnosis)
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
?confusionMatrix
class(result$Diagnosis)
caret::confusionMatrix(result$result, reference = "Diagnosis")
caret::confusionMatrix(result$result, reference = result$Diagnosis)
caret::confusionMatrix(result$result, result$Diagnosis)
p_load(e1071)
pacman::p_load(e1071)
caret::confusionMatrix(result$result, result$Diagnosis)
cvms::confusion_matrix(result$result, result$Diagnosis)
cvms::confusion_matrix(result$result, result$Diagnosis)[[1]]
caret::confusionMatrix(result$result, result$Diagnosis)
summary(cvms::confusion_matrix(result$result, result$Diagnosis))
summary(cvms::confusion_matrix(result$result, result$Diagnosis)[[1]])
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
cvms::confusion_matrix(result$result, result$Diagnosis)[[1]]
?cross_validate()
View(result)
caret::confusionMatrix(result$result, result$Diagnosis)
predict_to_tibble(simple_model) %>%
left_join(danish_df) %>%
select(pred, Diagnosis) %>%
summarise(mean(pred == Diagnosis))
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = as.factor(if_else(pred < 0.5, "Control", "Schizophrenia"))) %>%
select(result, Diagnosis)
cvms::confusion_matrix(result$result, result$Diagnosis)[[1]]
caret::confusionMatrix(result$result, result$Diagnosis)
raw_df <- read_csv("../a3-1/finalish_data.csv")
raw_df %>%
mutate(
Language = as.factor(Language),
diagnosis = as.factor(diagnosis),
real_ID = as.factor(real_ID),
freq_iqr = as.numeric(freq_iqr)
)
raw_df$Diagnosis <- as.factor(raw_df$Diagnosis)
danish_df <- raw_df %>%
filter(Language == "Danish") %>%
mutate(row_num = row_number(),
real_ID = as.factor(real_ID))
simple_model <- lme4::glmer(formula = Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study), data = danish_df, family = "binomial")
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = as.factor(if_else(pred < 0.5, "Control", "Schizophrenia"))) %>%
select(result, Diagnosis)
cvms::confusion_matrix(result$result, result$Diagnosis)[[1]]
caret::confusionMatrix(result$result, result$Diagnosis)
caret::confusionMatrix(result$Diagnosis, result$result)
result <- simple_model %>%
augment %>%
mutate(pred = logit2prob(.fitted),
result = as.factor(if_else(pred < 0.5, "Control", "Schizophrenia"))) %>%
select(result, Diagnosis)
caret::confusionMatrix(result$result, result$Diagnosis)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.folds)
?cross_validate()
cvms::cross_validate(danish_df,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial")
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.folds) %>%
left_join(danish_df)
d <- fold(danish_df,
k = 5,
cat_col = "Diagnosis",
id_col = "real_ID") %>%
arrange(.folds)
d
cvms::cross_validate(danish_df,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial",
fold_cols = ".folds")
cvms::cross_validate(data = danish_df,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial",
fold_cols = ".folds")
cvms::cross_validate(data = d,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial",
fold_cols = ".folds")
cross <- cvms::cross_validate(data = d,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial",
fold_cols = ".folds")
cross <- cvms::cross_validate(data = d,
formulas = "Diagnosis ~ freq_iqr + (1|real_ID) + (1|Study)",
REML = F,
family = "binomial",
fold_cols = ".folds")
```
cross$result
cross$Results
cross$Results[[1]]
cross <- cvms::cross_validate(data = d,
formulas = "Diagnosis ~ freq_iqr",
REML = F,
family = "binomial",
fold_cols = ".folds")
cross$Results[[1]]
cross$`Balanced Accuracy`
cross$`Confusion Matrix`
library(ggplot2)
